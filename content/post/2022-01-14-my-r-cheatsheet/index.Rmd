---
title: R随手记（1）
author: Luo Fei
date: '2022-01-12'
slug: Rcheatsheet
categories:
  - Tec
tags:
  - R
output:
    blogdown::html_page:
        number_sections: true  
math: true
showToc: true
TocOpen: false
toc-title: "目录"
draft: true
hidemeta: false
comments: false
description: "记录使用R过程一些记不住的技巧。"
canonicalURL: ""
disableShare: false
hideSummary: false
searchHidden: false
ShowReadingTime: false
ShowBreadCrumbs: true
ShowPostNavLinks: true
cover:
    image: "" # image path/url
    alt: "<alt text>" # alt text
    caption: "<text>" # display caption under cover
    relative: false # when using page bundles set this to true
    hidden: true # only hide on current single page  
---

```{r,setup,include=FALSE}
library(tidyverse)
options(digits = 3)

##knitr设置
knitr::opts_chunk$set(
  prompt = FALSE,
  comment = "#",
  results = "markup",
  error = FALSE,
  message = FALSE,
  fig.align = "center",
  collapse = FALSE,
  tidy = TRUE
  )

```

# R基础相关

## 数学公式测试

行内公式$x^2+y^2=z^2$

行间公式:$$f(x)=ax+b$$


## 逻辑运算符号

R中基础逻辑运算符号有（`=`;`!=`;`>`;`<`;`>=`;`<=`），返回的值是`true`和`false`，也可分别作为为数字`1`和`0`进行数学运算：

```{r}
x <- c(1,2,3,4,5,6)
x > 3
sum(x > 3)
```


## 数学运算

- %% 两个向量求余
```{r}
x <- c(1, 2, 3)
y <- c(4, 5, 6)
y %% x
```
- %/% 两个向量相除求商
```{r}
x <- c(1, 2, 3)
y <- c(4, 5, 6)
y %/% x
```

- %*% 两个向量的内积，也称为点乘，可用于矩阵

  - 对于向量
  
```{r}
x <- c(1, 2, 3)
y <- c(4, 5, 6)
y %*% x
```
  
  - 对于矩阵
  
```{r}
m <- matrix(c(1:4), ncol = 2)
m %*% m
```
## 向量操作

增加向量元素的几种操作

- 直接使用`c()`

```{r}
x <- c(1, 2, 3)
newvalues <- 4:9
c(x, newvalues)

```

- 在末尾添加

```{r}
x <- c(1, 2, 3)
x[length(x)+1] <- 99
x
```
 
- 在指定位置增加`append(VEC, newvalues, after = N)`：

```{r}
x <- c(1, 2, 3)
newvalues <- c(55, 66, 77)
append(x, newvalues, 2)
```

## `[]`和`[[]]`取值的区别,`[[]]`等价与`$`取元素:

```{r}
x <- c(1, 2, 3)
x[1]
x[[1]]
lsx <- list(name = c("tom", "jimy", "tod"), score = c(98, 80, 95))
lsx[2][1]
lsx[[2]][1]
lsx$score[1]
```



## `list`的一些操作和理解

`list`作为特殊的变量，它可以存储任意类型的数据，包括其他的`list`，也就是列表列。R中列表的高端操作有些抽象，不太好理解，需要自己动手多操作。


## `print()`和`cat()`的区别

主要是输出内容的形式，直观来说`cat()`输入的内容更复核自然阅读的习惯,而`print()`输入的内容更类似程序的语法结构

### 这是`print()`输出的结果

```{r}
print(c("hello", "world","!"))

```

### 这是`cat()`输出的结果

```{r}
cat(c("hello", "world","!"))

```

## 创建序列的区别

使用`:`创建的都是整数序列，使用`seq()`创建的序列是`double`。

```{r}
a <- 1:10
b <- seq(from = 1, to = 10, by = 1)
identical(a, b)
```

# 统计分析相关

## 概率

- R中有关概率分布相关函数（\@ref(tab:tabprob)）


Table:(\#tab:tabprob) 正态分布相关函数用法

| 函数    |  功能|
|:-------|:-------|
|dnorm(x, mean = 0, sd = 1, log = FALSE)|返回值正态分布概率密度函数值，比如dnorm（z）表示：标准正态分布密度函$f(x)$在x=z处的函数值。|
|pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)  | 返回值是正态分布的分布函数值，比如pnorm(z)等价于$P[X ≤ z]$|
|qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)  |返回值是给定概率p后的下分位点.|
|rnorm(n, mean = 0, sd = 1)|返回值是n个正态分布随机数构成的向量。|

- 其他概率分布（\@ref(tab:tabprob2)），其命令用法与正态分布函数类似。


Table:(\#tab:tabprob2) R中其他概率分布相关函数

|概率分布|	R 命令名 | 参数
|:-------:|:-------:|:-------
Beta	|beta	|shape1; shape2
Cauchy|	cauchy	|location; scale
Chi-squared (Chisquare)|	chisq	|df = degrees of freedom
Exponential	|exp|	rate
F|	f|df1 and df2 = degrees of freedom
Gamma|	gamma|	rate; either rate or scale
Log-normal (Lognormal)	|lnorm|meanlog = mean on logarithmic scale; sdlog = standard deviation on logarithmic scale
Logistic|	logis	|location; scale
Normal|	norm	|mean; sd = standard deviation
Student’s| t |(TDist)	t	df = degrees of freedom
Uniform|	unif|	min = lower limit; max = upper limit
Weibull|	weibull	|shape; scale
Wilcoxon|	wilcox|	m = number of observations in first sample; n = number of observations in second sample

## 基础统计


- `sd()`和`var()`分别计算标准差和方差

```{r}
x <- runif(20)
y <- 2*(x+1)
sd(x)
var(x)


```


- `cor()`和`cov()`函数可以分别计算两个向量之间的相关性和协方差：


```{r}
cor(x, y)
cov(x, y)
```


## 线性回归

- 线性回归语法`lm()`

### 一简单线性模型

```
lm(y ~ x1 + x2, date = sim)

```
对应建模公式为：$$y=\alpha+\beta_1x_1+\beta_2x_2+\varepsilon$$

### 交互变量性模型

```
lm(y ~ x1 * x2, date = sim)

```
对应建模公式为：$$y=\alpha+\beta_1x_1+\beta_2x_2++\beta_3x_1x_2+\varepsilon$$

### 虚拟变量

```
lm(y ~ x1 + x1:x2, date = sim)

```
对应建模公式为：$$y=\alpha+\beta_1x_1+\beta_2x_1x_2+\varepsilon$$


# rmarkdown相关

## 表格

- `kable()`

```{r}
knitr::kable(head(mtcars))
```


- 除了`kable()`命令生成表格外,其他的表格生成如果要使其能被交叉引用,需要添加标签`label`,如:`Table:(\#tab:yourlabel)Caption`,然后使用`\@ref(tab:label)` 。例如：

样本身高体重见表\@ref(tab:table001)

```
Table:(\#tab:table001)A simple table

left  | center | right
:-----|:------:|------:
A     |   180  | 60
B     |   160  | 50
c     |   170  | 30        

```

Table:(\#tab:table001)A simple table

left  | center | right
:-----|:------:|------:
A     |   180  | 60
B     |   160  | 50
c     |   170  | 30     



## 图片

微信截图的图片不能被`knit`正确读取，会提示找不到文件，需要更改文件类型或者名字？

