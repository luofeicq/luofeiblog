---
title: 上海疫情数据简单可视化分析(4月20日更新)
author: Luo Fei
date: '2022-03-24'
slug: covidsh
categories:
  - 中文
tags:
  - Tec
  - R
output:
    blogdown::html_page:
        number_sections: true
math: true
showToc: true
TocOpen: false
toc-title: "目录"
draft: false
hidemeta: false
comments: false
description: "无责任猜测。"
canonicalURL: ""
disableShare: false
hideSummary: false
searchHidden: false
ShowReadingTime: false
ShowBreadCrumbs: true
ShowPostNavLinks: true
cover:
    image: "" # image path/url
    alt: "<alt text>" # alt text
    caption: "<text>" # display caption under cover
    relative: false # when using page bundles set this to true
    hidden: true # only hide on current single page    
---



<p>今天本地的疫情终于没有增加，抽了点时间关注其他地区的疫情形势。看官方通报的数据，对曾经的模范城市的疫情有兴趣，决定来简单看看。</p>
<div id="数据获取" class="section level1" number="1">
<h1><span class="header-section-number">1</span> 数据获取</h1>
<div id="数据来源" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> 数据来源</h2>
<p>要获取准确的数据，当然是上官方网站。打开上海市卫健委的官网(<a href="https://wsjkw.sh.gov.cn/xwfb/index.html" class="uri">https://wsjkw.sh.gov.cn/xwfb/index.html</a>)，疫情数据公告都在“新闻发布”栏目中疫情信息的标题中就包含了所有新增、确诊数据。真是太方便了。</p>
<pre class="r"><code>library(rvest)
library(tidyverse)
library(lubridate)
library(readxl)
library(openxlsx)
library(ggforce)
library(mgcv)
library(deSolve)
library(FME)</code></pre>
</div>
<div id="数据" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> 数据</h2>
<p>上海的疫情变化主要从3月开始</p>
</div>
<div id="数据清洗" class="section level2" number="1.3">
<h2><span class="header-section-number">1.3</span> 数据清洗</h2>
<p>这一步比较麻烦的是对标题中日期字符的整理。使用<code>str_extract_all</code>命令后提取的日期，变成了列表。再合并为向量形势的日期格式数据时出了点麻烦。最后使用了笨办法<code>for</code>循环<code>unlist</code>后再<code>paste0</code>合并。其实直接用标题前的日期-1没什么大的误差，主要是在跟自己较劲搞得这么麻烦。</p>
</div>
</div>
<div id="好了开始分析吧" class="section level1" number="2">
<h1><span class="header-section-number">2</span> 好了，开始分析吧</h1>
<div id="先画个简单的图看看大趋势" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> 先画个简单的图看看大趋势</h2>
<p>以报告感染者类型为颜色看，从20年1月到21年12月期间，上海的感染人数几乎在处于一个长期稳定的状态，从2022年3月开始呈直升飞机式的增长。奇怪的是中间咋有个空白区，没有数据。查看原始网页，发现网站从2021年11月6日-2022年1月1日没有更新数据。这是一个奇怪的现象。不过没关系，这不影响我们后面的分析，<del>这对原因分析有很大关系</del>。</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="输入感染者的趋势" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> 输入感染者的趋势</h2>
<p>对上海这波疫情有个合理的猜测是，1月初上海接纳大量某地的航班的，导致上海市输入疫情压力陡增，再加上Omicron变异株超强传播能力，双重压力下导致这个模范城市失守。好吧，我们来看看是否能验证输入压力陡增这个猜测。从图上看新增输入的感染者数量变化并不大，鉴于确诊和无症状都属与感染这，下一步我们把本地和输入的感染者的合计数的变化可视化看看。</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="感染者总数" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> 感染者总数</h2>
<p>先用二者做个散点图看看,如图，完全看不出啥关系啊。。。。输入感染者较多的时候，反而本地感染处于低水平。这个图像，线性回归暂时也不考虑。我们还是从感染者数量和时间的关系看看。</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>画出来如下，大致能看出在3月14日前，上海几乎没有本土感染病例。
<img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="年3-4月" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> 2022年3-4月</h2>
<p>我们把时间尺度拉大到2月中旬到3月看看。放大后（下图1）到3月14日，输入感染人数开始上升，此时上海本地感染数量仍然无幅度的改变，处于平稳状态。为了更仔细看清楚变化情况，我们将y轴的数量调整至0-1000例，这时候能清楚看到每天的变化，本地感染者（蓝色）数量从3月16日快速上升者。</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="重点关注3月的数据" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> 重点关注3月的数据</h2>
</div>
<div id="地区分布" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> 地区分布</h2>
<p>获取了地区分布的疫情数据，结果很明显，浦东新区感染者数量最多，见下表：</p>
<table>
<colgroup>
<col width="2%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Local</th>
<th align="right">2022-04-14</th>
<th align="right">2022-04-16</th>
<th align="right">2022-04-07</th>
<th align="right">2022-04-18</th>
<th align="right">2022-04-06</th>
<th align="right">2022-04-11</th>
<th align="right">2022-04-05</th>
<th align="right">2022-04-17</th>
<th align="right">2022-04-08</th>
<th align="right">2022-04-04</th>
<th align="right">2022-04-10</th>
<th align="right">2022-04-09</th>
<th align="right">2022-03-28</th>
<th align="right">2022-03-31</th>
<th align="right">2022-03-30</th>
<th align="right">2022-03-29</th>
<th align="right">2022-04-15</th>
<th align="right">2022-04-12</th>
<th align="right">2022-04-01</th>
<th align="right">2022-04-02</th>
<th align="right">2022-03-24</th>
<th align="right">2022-03-26</th>
<th align="right">2022-04-03</th>
<th align="right">2022-03-23</th>
<th align="right">2022-03-20</th>
<th align="right">2022-03-21</th>
<th align="right">2022-03-19</th>
<th align="right">2022-03-22</th>
<th align="right">2022-03-25</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">浦东新区</td>
<td align="right">11656</td>
<td align="right">10791</td>
<td align="right">9050</td>
<td align="right">8831</td>
<td align="right">8457</td>
<td align="right">8306</td>
<td align="right">8145</td>
<td align="right">7740</td>
<td align="right">7286</td>
<td align="right">7071</td>
<td align="right">6732</td>
<td align="right">NA</td>
<td align="right">2506</td>
<td align="right">2407</td>
<td align="right">2207</td>
<td align="right">2183</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">193</td>
<td align="right">323</td>
<td align="right">NA</td>
<td align="right">436</td>
<td align="right">220</td>
<td align="right">169</td>
<td align="right">135</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">闵行区</td>
<td align="right">2378</td>
<td align="right">3060</td>
<td align="right">2257</td>
<td align="right">1372</td>
<td align="right">2409</td>
<td align="right">3007</td>
<td align="right">2937</td>
<td align="right">2402</td>
<td align="right">2854</td>
<td align="right">1381</td>
<td align="right">3189</td>
<td align="right">4624</td>
<td align="right">NA</td>
<td align="right">392</td>
<td align="right">780</td>
<td align="right">988</td>
<td align="right">2037</td>
<td align="right">NA</td>
<td align="right">1043</td>
<td align="right">829</td>
<td align="right">980</td>
<td align="right">972</td>
<td align="right">NA</td>
<td align="right">256</td>
<td align="right">NA</td>
<td align="right">122</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">黄浦区</td>
<td align="right">2013</td>
<td align="right">1565</td>
<td align="right">1380</td>
<td align="right">3323</td>
<td align="right">1044</td>
<td align="right">2223</td>
<td align="right">658</td>
<td align="right">1896</td>
<td align="right">2607</td>
<td align="right">970</td>
<td align="right">1761</td>
<td align="right">548</td>
<td align="right">NA</td>
<td align="right">121</td>
<td align="right">361</td>
<td align="right">110</td>
<td align="right">1384</td>
<td align="right">NA</td>
<td align="right">260</td>
<td align="right">659</td>
<td align="right">204</td>
<td align="right">320</td>
<td align="right">824</td>
<td align="right">40</td>
<td align="right">42</td>
<td align="right">98</td>
<td align="right">72</td>
<td align="right">118</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">徐汇区</td>
<td align="right">1342</td>
<td align="right">1532</td>
<td align="right">2076</td>
<td align="right">572</td>
<td align="right">1107</td>
<td align="right">1771</td>
<td align="right">920</td>
<td align="right">1553</td>
<td align="right">1629</td>
<td align="right">1229</td>
<td align="right">3203</td>
<td align="right">1150</td>
<td align="right">NA</td>
<td align="right">226</td>
<td align="right">404</td>
<td align="right">1100</td>
<td align="right">1689</td>
<td align="right">1108</td>
<td align="right">639</td>
<td align="right">1042</td>
<td align="right">167</td>
<td align="right">331</td>
<td align="right">NA</td>
<td align="right">212</td>
<td align="right">46</td>
<td align="right">130</td>
<td align="right">122</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">松江区</td>
<td align="right">1166</td>
<td align="right">646</td>
<td align="right">1288</td>
<td align="right">762</td>
<td align="right">781</td>
<td align="right">1340</td>
<td align="right">796</td>
<td align="right">1504</td>
<td align="right">1326</td>
<td align="right">1106</td>
<td align="right">3068</td>
<td align="right">500</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">476</td>
<td align="right">428</td>
<td align="right">773</td>
<td align="right">712</td>
<td align="right">948</td>
<td align="right">567</td>
<td align="right">184</td>
<td align="right">158</td>
<td align="right">NA</td>
<td align="right">68</td>
<td align="right">18</td>
<td align="right">76</td>
<td align="right">32</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">宝山区</td>
<td align="right">417</td>
<td align="right">1293</td>
<td align="right">414</td>
<td align="right">1030</td>
<td align="right">660</td>
<td align="right">1024</td>
<td align="right">554</td>
<td align="right">1450</td>
<td align="right">2821</td>
<td align="right">265</td>
<td align="right">1839</td>
<td align="right">2261</td>
<td align="right">311</td>
<td align="right">17</td>
<td align="right">504</td>
<td align="right">363</td>
<td align="right">1323</td>
<td align="right">NA</td>
<td align="right">45</td>
<td align="right">485</td>
<td align="right">87</td>
<td align="right">153</td>
<td align="right">NA</td>
<td align="right">138</td>
<td align="right">26</td>
<td align="right">134</td>
<td align="right">NA</td>
<td align="right">32</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">普陀区</td>
<td align="right">264</td>
<td align="right">1331</td>
<td align="right">957</td>
<td align="right">371</td>
<td align="right">1033</td>
<td align="right">1878</td>
<td align="right">483</td>
<td align="right">1225</td>
<td align="right">1094</td>
<td align="right">254</td>
<td align="right">1001</td>
<td align="right">653</td>
<td align="right">NA</td>
<td align="right">15</td>
<td align="right">146</td>
<td align="right">113</td>
<td align="right">426</td>
<td align="right">1170</td>
<td align="right">245</td>
<td align="right">388</td>
<td align="right">38</td>
<td align="right">69</td>
<td align="right">NA</td>
<td align="right">68</td>
<td align="right">36</td>
<td align="right">31</td>
<td align="right">50</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">杨浦区</td>
<td align="right">817</td>
<td align="right">860</td>
<td align="right">601</td>
<td align="right">481</td>
<td align="right">630</td>
<td align="right">1420</td>
<td align="right">623</td>
<td align="right">887</td>
<td align="right">701</td>
<td align="right">220</td>
<td align="right">1877</td>
<td align="right">1080</td>
<td align="right">NA</td>
<td align="right">174</td>
<td align="right">100</td>
<td align="right">99</td>
<td align="right">1411</td>
<td align="right">NA</td>
<td align="right">134</td>
<td align="right">274</td>
<td align="right">21</td>
<td align="right">23</td>
<td align="right">NA</td>
<td align="right">22</td>
<td align="right">16</td>
<td align="right">20</td>
<td align="right">28</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">嘉定区</td>
<td align="right">803</td>
<td align="right">685</td>
<td align="right">933</td>
<td align="right">588</td>
<td align="right">NA</td>
<td align="right">208</td>
<td align="right">481</td>
<td align="right">978</td>
<td align="right">1505</td>
<td align="right">237</td>
<td align="right">1405</td>
<td align="right">369</td>
<td align="right">NA</td>
<td align="right">54</td>
<td align="right">158</td>
<td align="right">255</td>
<td align="right">741</td>
<td align="right">986</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">130</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">69</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">81</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">虹口区</td>
<td align="right">930</td>
<td align="right">1027</td>
<td align="right">594</td>
<td align="right">1092</td>
<td align="right">668</td>
<td align="right">1375</td>
<td align="right">410</td>
<td align="right">1166</td>
<td align="right">378</td>
<td align="right">608</td>
<td align="right">1238</td>
<td align="right">349</td>
<td align="right">NA</td>
<td align="right">128</td>
<td align="right">84</td>
<td align="right">73</td>
<td align="right">1497</td>
<td align="right">931</td>
<td align="right">61</td>
<td align="right">342</td>
<td align="right">58</td>
<td align="right">50</td>
<td align="right">NA</td>
<td align="right">52</td>
<td align="right">24</td>
<td align="right">46</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">静安区</td>
<td align="right">266</td>
<td align="right">1134</td>
<td align="right">381</td>
<td align="right">1010</td>
<td align="right">545</td>
<td align="right">552</td>
<td align="right">302</td>
<td align="right">842</td>
<td align="right">665</td>
<td align="right">50</td>
<td align="right">603</td>
<td align="right">602</td>
<td align="right">104</td>
<td align="right">164</td>
<td align="right">102</td>
<td align="right">175</td>
<td align="right">433</td>
<td align="right">1056</td>
<td align="right">189</td>
<td align="right">324</td>
<td align="right">70</td>
<td align="right">108</td>
<td align="right">338</td>
<td align="right">96</td>
<td align="right">64</td>
<td align="right">88</td>
<td align="right">30</td>
<td align="right">NA</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">长宁区</td>
<td align="right">998</td>
<td align="right">706</td>
<td align="right">852</td>
<td align="right">680</td>
<td align="right">350</td>
<td align="right">393</td>
<td align="right">84</td>
<td align="right">739</td>
<td align="right">614</td>
<td align="right">33</td>
<td align="right">387</td>
<td align="right">757</td>
<td align="right">115</td>
<td align="right">256</td>
<td align="right">128</td>
<td align="right">30</td>
<td align="right">752</td>
<td align="right">1133</td>
<td align="right">74</td>
<td align="right">100</td>
<td align="right">118</td>
<td align="right">29</td>
<td align="right">NA</td>
<td align="right">22</td>
<td align="right">13</td>
<td align="right">52</td>
<td align="right">24</td>
<td align="right">38</td>
<td align="right">8</td>
</tr>
<tr class="odd">
<td align="left">青浦区</td>
<td align="right">304</td>
<td align="right">305</td>
<td align="right">493</td>
<td align="right">257</td>
<td align="right">470</td>
<td align="right">331</td>
<td align="right">384</td>
<td align="right">369</td>
<td align="right">342</td>
<td align="right">314</td>
<td align="right">877</td>
<td align="right">557</td>
<td align="right">NA</td>
<td align="right">95</td>
<td align="right">77</td>
<td align="right">174</td>
<td align="right">536</td>
<td align="right">524</td>
<td align="right">174</td>
<td align="right">231</td>
<td align="right">26</td>
<td align="right">44</td>
<td align="right">NA</td>
<td align="right">20</td>
<td align="right">8</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">40</td>
<td align="right">26</td>
</tr>
<tr class="even">
<td align="left">奉贤区</td>
<td align="right">35</td>
<td align="right">51</td>
<td align="right">92</td>
<td align="right">14</td>
<td align="right">556</td>
<td align="right">68</td>
<td align="right">144</td>
<td align="right">20</td>
<td align="right">97</td>
<td align="right">64</td>
<td align="right">38</td>
<td align="right">124</td>
<td align="right">230</td>
<td align="right">183</td>
<td align="right">130</td>
<td align="right">96</td>
<td align="right">106</td>
<td align="right">33</td>
<td align="right">161</td>
<td align="right">157</td>
<td align="right">48</td>
<td align="right">168</td>
<td align="right">119</td>
<td align="right">12</td>
<td align="right">26</td>
<td align="right">22</td>
<td align="right">12</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">崇明区</td>
<td align="right">62</td>
<td align="right">72</td>
<td align="right">520</td>
<td align="right">NA</td>
<td align="right">126</td>
<td align="right">0</td>
<td align="right">79</td>
<td align="right">NA</td>
<td align="right">334</td>
<td align="right">94</td>
<td align="right">0</td>
<td align="right">171</td>
<td align="right">NA</td>
<td align="right">44</td>
<td align="right">386</td>
<td align="right">55</td>
<td align="right">92</td>
<td align="right">86</td>
<td align="right">166</td>
<td align="right">113</td>
<td align="right">164</td>
<td align="right">54</td>
<td align="right">NA</td>
<td align="right">108</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">38</td>
<td align="right">82</td>
</tr>
<tr class="even">
<td align="left">金山区</td>
<td align="right">28</td>
<td align="right">21</td>
<td align="right">129</td>
<td align="right">NA</td>
<td align="right">79</td>
<td align="right">38</td>
<td align="right">77</td>
<td align="right">NA</td>
<td align="right">90</td>
<td align="right">52</td>
<td align="right">57</td>
<td align="right">68</td>
<td align="right">NA</td>
<td align="right">42</td>
<td align="right">66</td>
<td align="right">26</td>
<td align="right">31</td>
<td align="right">39</td>
<td align="right">49</td>
<td align="right">120</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">22</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>画个玫瑰图看看，其实这个图并并能很好反应数据特征。</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>感觉还不如单纯的条图清晰</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="发现途径数据获取" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> 发现途径数据获取</h2>
<p>获取数据信息如下</p>
<table>
<colgroup>
<col width="10%" />
<col width="6%" />
<col width="6%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="9%" />
<col width="8%" />
<col width="11%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">rep_date</th>
<th align="right">case_c</th>
<th align="right">case_u</th>
<th align="right">case_c_zh</th>
<th align="right">case_c_gk</th>
<th align="right">case_u_gk</th>
<th align="right">case_c_fx</th>
<th align="right">case_u_fx</th>
<th align="right">case_all</th>
<th align="right">case_all_gk</th>
<th align="right">case_all_fx</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">2022-04-18</td>
<td align="right">3084</td>
<td align="right">17332</td>
<td align="right">0</td>
<td align="right">1894</td>
<td align="right">16998</td>
<td align="right">3084</td>
<td align="right">334</td>
<td align="right">20416</td>
<td align="right">18892</td>
<td align="right">1524</td>
</tr>
<tr class="even">
<td align="left">2022-04-17</td>
<td align="right">2417</td>
<td align="right">19831</td>
<td align="right">853</td>
<td align="right">1409</td>
<td align="right">19425</td>
<td align="right">1564</td>
<td align="right">406</td>
<td align="right">21395</td>
<td align="right">20834</td>
<td align="right">561</td>
</tr>
<tr class="odd">
<td align="left">2022-04-16</td>
<td align="right">3238</td>
<td align="right">21582</td>
<td align="right">1177</td>
<td align="right">1754</td>
<td align="right">21167</td>
<td align="right">2061</td>
<td align="right">415</td>
<td align="right">23643</td>
<td align="right">22921</td>
<td align="right">722</td>
</tr>
<tr class="even">
<td align="left">2022-04-15</td>
<td align="right">3590</td>
<td align="right">19923</td>
<td align="right">922</td>
<td align="right">2311</td>
<td align="right">19428</td>
<td align="right">2668</td>
<td align="right">495</td>
<td align="right">22591</td>
<td align="right">21739</td>
<td align="right">852</td>
</tr>
<tr class="odd">
<td align="left">2022-04-14</td>
<td align="right">3200</td>
<td align="right">19872</td>
<td align="right">307</td>
<td align="right">2547</td>
<td align="right">19494</td>
<td align="right">2893</td>
<td align="right">378</td>
<td align="right">22765</td>
<td align="right">22041</td>
<td align="right">724</td>
</tr>
<tr class="even">
<td align="left">2022-04-13</td>
<td align="right">2573</td>
<td align="right">25146</td>
<td align="right">114</td>
<td align="right">2200</td>
<td align="right">24548</td>
<td align="right">2459</td>
<td align="right">598</td>
<td align="right">27605</td>
<td align="right">26748</td>
<td align="right">857</td>
</tr>
</tbody>
</table>
</div>
<div id="时间分布" class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> 时间分布</h2>
<p>首先看看的大体趋势，从3月13日起，随着时间感染者数量几乎是成指数增加。但是从风险人群（红线）中检出感染者数量似乎有下降的迹象。
<img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="人群分布" class="section level2" number="2.9">
<h2><span class="header-section-number">2.9</span> 人群分布</h2>
<p>再看看每天感染者发现途径的变化情况。红色代表每天从风险人群中发现感染者，蓝色代表从管控人群。可见从风险人群中发现感染者的比例大体趋势是逐渐减少的。这种情况视乎是一个好的征兆。但同时需要考虑随着防控政策的变化，对两类人群的定义是否也随之变化？
<img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" />
再单独看看风险人群中检出感染者的情况，从了4月3日，4月4日连续两天下降，且看起来几乎是呈直线下降，这是一个好兆头。预示着，随着大规模核酸检测工作的全面铺开，从社会面发现感染者数量的增长势头将会慢慢遏制。</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="简单总结" class="section level1" number="3">
<h1><span class="header-section-number">3</span> 简单总结</h1>
<p>从上面的简单分析可得知，上海市境外输入感染者数量，从去年2月20日左右开始上升，增加的幅度从平均12例左右，到2月24左右达到85例左右。确实存在一个数量快速增加的阶段，之后过了大概一周的时间上海本地感染者开始快速上升，我们不得不猜测这二者之间可能存在某种联系。最后一张图添加了平滑曲线，做一个大致的预测。从图可见上海这一次疫情新增病人数量仍未到达所谓的“拐点”<del>没爬错数据</del>。随着检测人数的增加，防控措施的进一步加码和落实，相信这一波疫情会逐渐得到控制。</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="预测" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> 预测</h2>
<p>曲线拟合如下
<img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="动力学微分方程" class="section level1" number="4">
<h1><span class="header-section-number">4</span> 动力学微分方程</h1>
<p>由于数字获取不准确，缺失数据太多，无法顺利拟合。</p>
</div>
<div id="时间序列模型" class="section level1" number="5">
<h1><span class="header-section-number">5</span> 时间序列模型</h1>
<div id="加载相应的包" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> 加载相应的包</h2>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-24-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>机器学习模型</p>
<p>随机森林模型</p>
<p>propboost</p>
<p>校准模型</p>
<p>校准</p>
</div>
<div id="预测-1" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> 预测</h2>
<p>从最新的数字看几个模型都预测病例数量开始下降了。
<img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-30-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="准确率" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> 准确率</h2>
<p>从下表可见拟合度最高的前面1，2，5这3个模型。</p>
<div id="tgrnbkjrfr" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#tgrnbkjrfr .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tgrnbkjrfr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tgrnbkjrfr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tgrnbkjrfr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tgrnbkjrfr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tgrnbkjrfr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tgrnbkjrfr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tgrnbkjrfr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tgrnbkjrfr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tgrnbkjrfr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tgrnbkjrfr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tgrnbkjrfr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#tgrnbkjrfr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tgrnbkjrfr .gt_from_md > :first-child {
  margin-top: 0;
}

#tgrnbkjrfr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tgrnbkjrfr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tgrnbkjrfr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tgrnbkjrfr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tgrnbkjrfr .gt_row_group_first td {
  border-top-width: 2px;
}

#tgrnbkjrfr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgrnbkjrfr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tgrnbkjrfr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tgrnbkjrfr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tgrnbkjrfr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgrnbkjrfr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tgrnbkjrfr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tgrnbkjrfr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tgrnbkjrfr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tgrnbkjrfr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgrnbkjrfr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tgrnbkjrfr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tgrnbkjrfr .gt_left {
  text-align: left;
}

#tgrnbkjrfr .gt_center {
  text-align: center;
}

#tgrnbkjrfr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tgrnbkjrfr .gt_font_normal {
  font-weight: normal;
}

#tgrnbkjrfr .gt_font_bold {
  font-weight: bold;
}

#tgrnbkjrfr .gt_font_italic {
  font-style: italic;
}

#tgrnbkjrfr .gt_super {
  font-size: 65%;
}

#tgrnbkjrfr .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#tgrnbkjrfr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tgrnbkjrfr .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#tgrnbkjrfr .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#tgrnbkjrfr .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="gt_table">
  <thead class="gt_header">
    <tr>
      <th colspan="9" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Accuracy Table</th>
    </tr>
    
  </thead>
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">.model_id</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.model_desc</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">.type</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mae</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">mase</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">smape</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rsq</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">1</td>
<td class="gt_row gt_left">ARIMA(0,2,0)(1,0,0)[7]</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_right">16091</td>
<td class="gt_row gt_right">70</td>
<td class="gt_row gt_right">7.9</td>
<td class="gt_row gt_right">110</td>
<td class="gt_row gt_right">17419</td>
<td class="gt_row gt_right">0.73</td></tr>
    <tr><td class="gt_row gt_right">2</td>
<td class="gt_row gt_left">PROPHET</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_right">4144</td>
<td class="gt_row gt_right">16</td>
<td class="gt_row gt_right">2.0</td>
<td class="gt_row gt_right">18</td>
<td class="gt_row gt_right">5098</td>
<td class="gt_row gt_right">0.51</td></tr>
    <tr><td class="gt_row gt_right">3</td>
<td class="gt_row gt_left">GLMNET</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_right">5645</td>
<td class="gt_row gt_right">24</td>
<td class="gt_row gt_right">2.8</td>
<td class="gt_row gt_right">29</td>
<td class="gt_row gt_right">6285</td>
<td class="gt_row gt_right">0.69</td></tr>
    <tr><td class="gt_row gt_right">4</td>
<td class="gt_row gt_left">RANDOMFOREST</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_right">5064</td>
<td class="gt_row gt_right">21</td>
<td class="gt_row gt_right">2.5</td>
<td class="gt_row gt_right">23</td>
<td class="gt_row gt_right">5270</td>
<td class="gt_row gt_right">0.62</td></tr>
    <tr><td class="gt_row gt_right">5</td>
<td class="gt_row gt_left">PROPHET W/ XGBOOST ERRORS</td>
<td class="gt_row gt_left">Test</td>
<td class="gt_row gt_right">41657</td>
<td class="gt_row gt_right">186</td>
<td class="gt_row gt_right">20.5</td>
<td class="gt_row gt_right">146</td>
<td class="gt_row gt_right">52384</td>
<td class="gt_row gt_right">0.69</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
<div id="模型选择" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> 模型选择</h2>
<p>选择较好的几个模型预测</p>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-32-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="无责任预测" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> 无责任预测</h2>
<p>筛选1，2，3号模型的预测值如下:</p>
<pre><code>                    ACTUAL                         GLMNET 
                        51                              7 
 PROPHET W/ XGBOOST ERRORS                   RANDOMFOREST 
                         7                              7 </code></pre>
<p>UPDATE: ARIMA(0,1,1)(1,0,0)[7]
7</p>
<table>
<thead>
<tr class="header">
<th align="left">模型</th>
<th align="left">日期</th>
<th align="right">预测值</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">UPDATE: ARIMA(0,1,1)(1,0,0)[7]</td>
<td align="left">2022-04-20</td>
<td align="right">25183</td>
</tr>
<tr class="even">
<td align="left">UPDATE: ARIMA(0,1,1)(1,0,0)[7]</td>
<td align="left">2022-04-21</td>
<td align="right">25343</td>
</tr>
<tr class="odd">
<td align="left">UPDATE: ARIMA(0,1,1)(1,0,0)[7]</td>
<td align="left">2022-04-22</td>
<td align="right">25816</td>
</tr>
<tr class="even">
<td align="left">UPDATE: ARIMA(0,1,1)(1,0,0)[7]</td>
<td align="left">2022-04-23</td>
<td align="right">24885</td>
</tr>
<tr class="odd">
<td align="left">UPDATE: ARIMA(0,1,1)(1,0,0)[7]</td>
<td align="left">2022-04-24</td>
<td align="right">24221</td>
</tr>
<tr class="even">
<td align="left">UPDATE: ARIMA(0,1,1)(1,0,0)[7]</td>
<td align="left">2022-04-25</td>
<td align="right">25791</td>
</tr>
<tr class="odd">
<td align="left">UPDATE: ARIMA(0,1,1)(1,0,0)[7]</td>
<td align="left">2022-04-26</td>
<td align="right">26518</td>
</tr>
<tr class="even">
<td align="left">GLMNET</td>
<td align="left">2022-04-20</td>
<td align="right">20774</td>
</tr>
<tr class="odd">
<td align="left">GLMNET</td>
<td align="left">2022-04-21</td>
<td align="right">21470</td>
</tr>
<tr class="even">
<td align="left">GLMNET</td>
<td align="left">2022-04-22</td>
<td align="right">21162</td>
</tr>
<tr class="odd">
<td align="left">GLMNET</td>
<td align="left">2022-04-23</td>
<td align="right">22698</td>
</tr>
<tr class="even">
<td align="left">GLMNET</td>
<td align="left">2022-04-24</td>
<td align="right">23731</td>
</tr>
<tr class="odd">
<td align="left">GLMNET</td>
<td align="left">2022-04-25</td>
<td align="right">23387</td>
</tr>
<tr class="even">
<td align="left">GLMNET</td>
<td align="left">2022-04-26</td>
<td align="right">24047</td>
</tr>
<tr class="odd">
<td align="left">RANDOMFOREST</td>
<td align="left">2022-04-20</td>
<td align="right">22521</td>
</tr>
<tr class="even">
<td align="left">RANDOMFOREST</td>
<td align="left">2022-04-21</td>
<td align="right">22293</td>
</tr>
<tr class="odd">
<td align="left">RANDOMFOREST</td>
<td align="left">2022-04-22</td>
<td align="right">22183</td>
</tr>
<tr class="even">
<td align="left">RANDOMFOREST</td>
<td align="left">2022-04-23</td>
<td align="right">22285</td>
</tr>
<tr class="odd">
<td align="left">RANDOMFOREST</td>
<td align="left">2022-04-24</td>
<td align="right">22117</td>
</tr>
<tr class="even">
<td align="left">RANDOMFOREST</td>
<td align="left">2022-04-25</td>
<td align="right">22069</td>
</tr>
<tr class="odd">
<td align="left">RANDOMFOREST</td>
<td align="left">2022-04-26</td>
<td align="right">21950</td>
</tr>
<tr class="even">
<td align="left">PROPHET W/ XGBOOST ERRORS</td>
<td align="left">2022-04-20</td>
<td align="right">16590</td>
</tr>
<tr class="odd">
<td align="left">PROPHET W/ XGBOOST ERRORS</td>
<td align="left">2022-04-21</td>
<td align="right">16151</td>
</tr>
<tr class="even">
<td align="left">PROPHET W/ XGBOOST ERRORS</td>
<td align="left">2022-04-22</td>
<td align="right">15555</td>
</tr>
<tr class="odd">
<td align="left">PROPHET W/ XGBOOST ERRORS</td>
<td align="left">2022-04-23</td>
<td align="right">18211</td>
</tr>
<tr class="even">
<td align="left">PROPHET W/ XGBOOST ERRORS</td>
<td align="left">2022-04-24</td>
<td align="right">24903</td>
</tr>
<tr class="odd">
<td align="left">PROPHET W/ XGBOOST ERRORS</td>
<td align="left">2022-04-25</td>
<td align="right">27602</td>
</tr>
<tr class="even">
<td align="left">PROPHET W/ XGBOOST ERRORS</td>
<td align="left">2022-04-26</td>
<td align="right">35316</td>
</tr>
</tbody>
</table>
</div>
</div>
