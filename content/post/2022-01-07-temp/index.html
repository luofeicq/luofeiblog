---
title: Monte Carlo method
author: luofei # multiple authors["Me", "You"] 
date: '2022-01-07'
slug: [temp]
categories:
  - hogo
tags:
  - temp
output:
    blogdown::html_page:
      number_sections: true
# weight: 1
# aliases: ["/first"]
math: true
showToc: true
TocOpen: false
draft: false
hidemeta: false
comments: false
description: "mote carlo"
canonicalURL: ""
disableHLJS: false # to disable highlightjs
disableShare: false
hideSummary: false
searchHidden: false
ShowReadingTime: true
ShowBreadCrumbs: true
ShowPostNavLinks: true
cover:
    image: "" # image path/url
    alt: "<alt text>" # alt text
    caption: "<text>" # display caption under cover
    relative: false # when using page bundles set this to true
    hidden: true # only hide on current single page
 
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<div id="蒙特卡洛法monte-carlo-method计算pi的值" class="section level1" number="1">
<h1><span class="header-section-number">1</span> 蒙特卡洛法（Monte Carlo method）计算<span class="math inline">\(\pi\)</span>的值</h1>
<p>用随机函数<code>runif()</code>随机生成N个在1个单位正方形内的散点，根据三角公式筛选出在圆内的点,数据如下:</p>
<pre class="r"><code>## 生成基础数据

set.seed(2021)

N &lt;-  5000

df01 &lt;- tibble(
  x = runif(N, -0.5, 0.5),
  y = runif(N, -0.5, 0.5)
) %&gt;% 
  mutate(
    z = if_else(
      x^2 + y ^2 &lt; 0.25, 1, 0),
    p = runif(N,0,2 * pi),
    x2 = cos(p) * 0.5,
    y2 = sin(p) * 0.5
    )

knitr::kable(head(df01), caption = &quot;随机数据&quot;, col.names = c(&quot;散点X&quot;, &quot;散点Y&quot;, &quot;是否在圆内&quot;,
                                                          &quot;随机生成0-180度&quot;, &quot;圆X&quot;, &quot;圆Y&quot;), digits = 3, align = &quot;c&quot; )</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-1">表1.1: </span>随机数据</caption>
<thead>
<tr class="header">
<th align="center">散点X</th>
<th align="center">散点Y</th>
<th align="center">是否在圆内</th>
<th align="center">随机生成0-180度</th>
<th align="center">圆X</th>
<th align="center">圆Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-0.049</td>
<td align="center">-0.208</td>
<td align="center">1</td>
<td align="center">4.580</td>
<td align="center">-0.066</td>
<td align="center">-0.496</td>
</tr>
<tr class="even">
<td align="center">0.284</td>
<td align="center">0.212</td>
<td align="center">1</td>
<td align="center">4.175</td>
<td align="center">-0.256</td>
<td align="center">-0.429</td>
</tr>
<tr class="odd">
<td align="center">0.210</td>
<td align="center">-0.395</td>
<td align="center">1</td>
<td align="center">1.947</td>
<td align="center">-0.184</td>
<td align="center">0.465</td>
</tr>
<tr class="even">
<td align="center">-0.118</td>
<td align="center">0.204</td>
<td align="center">1</td>
<td align="center">2.000</td>
<td align="center">-0.208</td>
<td align="center">0.455</td>
</tr>
<tr class="odd">
<td align="center">0.136</td>
<td align="center">-0.286</td>
<td align="center">1</td>
<td align="center">2.294</td>
<td align="center">-0.331</td>
<td align="center">0.375</td>
</tr>
<tr class="even">
<td align="center">0.201</td>
<td align="center">0.447</td>
<td align="center">1</td>
<td align="center">4.296</td>
<td align="center">-0.202</td>
<td align="center">-0.457</td>
</tr>
</tbody>
</table>
<div id="绘图" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> 绘图</h2>
<p>画出散点的分布图。</p>
<pre class="r"><code>## 绘图
df01 %&gt;% ggplot() +
  geom_point(aes(x, y, col= as.factor(z)),
             alpha = 0.5, size = 0.5, show.legend = F) + 
  theme_bw() +
  geom_point(aes(x2,y2), alpha = 0.5, size = 0.5)</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:fig001"></span>
<img src="{{< blogdown/postref >}}index_files/figure-html/fig001-1.png" alt="1个单位正方形内的散点" width="576" />
<p class="caption">
图1.1: 1个单位正方形内的散点
</p>
</div>
</div>
<div id="计算hatpi" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> 计算<span class="math inline">\(\hat\pi\)</span></h2>
<p>根据面积比可得<span class="math inline">\(\hat\pi=4\frac{^{ }S_c}{S_s}\)</span>。当分布5000个点的时候,<span class="math inline">\(\hat\pi=\frac{3925\times4}{5000}=\)</span> 3.14。以实验投掷散点数量为X轴，以估的<span class="math inline">\(\hat\pi\)</span>为Y轴绘图如下。很明显地可以看出随着点的数量增多<span class="math inline">\(\hat\pi\)</span>逐渐向<span class="math inline">\(\pi\)</span>真实值（蓝线）逼近。</p>
<pre class="r"><code>estmatepi &lt;- tibble(y = cumsum(df01$z)/(1:N)*4,
                    x = 1:N)
estmatepi %&gt;% ggplot(aes(x,y))+
  geom_line()+
  geom_hline(yintercept = pi, col = &quot;blue&quot;) +
  theme_classic() +
  xlab(&quot;N&quot;) +
  ylab(expression(hat(pi)))</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-2-1.png" alt="估计圆周率与实验次数关系" width="672" />
<p class="caption">
图1.2: 估计圆周率与实验次数关系
</p>
</div>
</div>
</div>
